<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buffers &mdash; Analog Devices Hardware Python Interfaces 0.0.9 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FPGA Features" href="../fpga/index.html" />
    <link rel="prev" title="ad7689" href="../devices/adi.ad7689.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Analog Devices Hardware Python Interfaces
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../guides/quick.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../attr/index.html">Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/connectivity.html">Connectivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devices/index.html">Supported Devices</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Buffers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cyclic-mode">Cyclic Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-adi.rx_tx">Members</a></li>
<li class="toctree-l2"><a class="reference internal" href="#buffer-examples">Buffer Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">FPGA Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Analog Devices Hardware Python Interfaces</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Buffers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/buffers/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="buffers">
<h1>Buffers<a class="headerlink" href="#buffers" title="Permalink to this headline"></a></h1>
<p>Using buffers or transmitting and receiving data is done through interacting with two methods.</p>
<p>For receivers this is the <strong>rx</strong> method. How data is captured and therefore produced by this method is dependent on two main properties:</p>
<ul class="simple">
<li><p><strong>rx_enabled_channels</strong>: This is an array of integers and the number of elements in the array will determine the number of list items returned by <strong>rx</strong>. For devices with complex data types these are the indexes of the complex channels, not the individual I or Q channels.</p></li>
<li><p><strong>rx_buffer_size</strong>: This is the number of samples returned in each column. If the device produces complex data, like a transceiver, it will return complex data. This is defined by the author of each device specific class.</p></li>
</ul>
<p>For transmitters this is the <strong>tx</strong> method. How data is sent and therefore must be passed by this method is dependent on one main property:</p>
<ul class="simple">
<li><p><strong>tx_enabled_channels</strong>: This is an array of integers and the number of elements in the array will determine the number of items in list to be submitted to <strong>tx</strong>. Like for <strong>rx_enabled_channels</strong>, devices with complex data types these are the indexes of the complex channels, not the individual I or Q channels.</p></li>
</ul>
<p><strong>rx_enabled_channels</strong> must have a length greater than zero but <strong>tx_enabled_channels</strong> can be set to None or an empty list. In this case when <strong>tx</strong> is called it must be called without inputs. This is a special case and will connect a zero source into the TX input stream within the FPGA for FPGA based devices. For background on how this internally works with FPGA based devices reference the generic <a class="reference external" href="https://wiki.analog.com/resources/tools-software/linux-drivers/iio-dds/axi-dac-dds-hdl">DAC driver</a>.</p>
<section id="cyclic-mode">
<h2>Cyclic Mode<a class="headerlink" href="#cyclic-mode" title="Permalink to this headline"></a></h2>
<p>In many cases, it can be useful to continuously transmit a signal over and over, even for just debugging and testing. This can be especially handy when the hardware you are using has very high transmit or receive rates, and therefore impossible to keep providing data to. To complement these use cases it is possible to create transmit buffer which repeats, which we call <strong>cylic buffers</strong>. Cyclic buffers are identical or normal or non-cylic buffers, except when they reach hardware they will continuously repeat or be transmitted. Here is a small example on how to create a cyclic buffer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">adi</span>

<span class="n">sdr</span> <span class="o">=</span> <span class="n">adi</span><span class="o">.</span><span class="n">ad9361</span><span class="p">()</span>
<span class="c1"># Create a complex sinusoid</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mi">3000000</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">30000000.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">fc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">fc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span>
<span class="n">iq</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">q</span>
<span class="c1"># Enable cyclic buffers</span>
<span class="n">sdr</span><span class="o">.</span><span class="n">tx_cyclic_buffer</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># Send data cyclically</span>
<span class="n">sdr</span><span class="o">.</span><span class="n">tx</span><span class="p">(</span><span class="n">iq</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, the transmitter will keep transmitting the create sinusoid indefinitely until the buffer is destroyed or the <em>sdr</em> object destructor is called. Once data is pushed to hardware with a cyclic buffer the buffer must be manually destroyed or an error will occur if more data push. To update the buffer use the <strong>tx_destroy_buffer</strong> method before passing a new vector to the <strong>tx</strong> method.</p>
</section>
<section id="module-adi.rx_tx">
<span id="members"></span><h2>Members<a class="headerlink" href="#module-adi.rx_tx" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="adi.rx_tx.rx">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">adi.rx_tx.</span></span><span class="sig-name descname"><span class="pre">rx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rx_buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adi.rx_tx.rx" title="Permalink to this definition"></a></dt>
<dd><p>Buffer handling for receive devices</p>
<dl class="py method">
<dt class="sig sig-object py" id="adi.rx_tx.rx.rx">
<span class="sig-name descname"><span class="pre">rx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#adi.rx_tx.rx.rx" title="Permalink to this definition"></a></dt>
<dd><p>Receive data from hardware buffers for each channel index in
rx_enabled_channels.</p>
<dl class="simple">
<dt>returns: type=numpy.array or list of numpy.array</dt><dd><p>An array or list of arrays when more than one receive channel
is enabled containing samples from a channel or set of channels.
Data will be complex when using a complex data device.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="adi.rx_tx.rx.rx_buffer_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">rx_buffer_size</span></span><a class="headerlink" href="#adi.rx_tx.rx.rx_buffer_size" title="Permalink to this definition"></a></dt>
<dd><p>rx_buffer_size: Size of receive buffer in samples</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="adi.rx_tx.rx.rx_destroy_buffer">
<span class="sig-name descname"><span class="pre">rx_destroy_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#adi.rx_tx.rx.rx_destroy_buffer" title="Permalink to this definition"></a></dt>
<dd><p>rx_destroy_buffer: Clears RX buffer</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="adi.rx_tx.rx.rx_enabled_channels">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">rx_enabled_channels</span></span><a class="headerlink" href="#adi.rx_tx.rx.rx_enabled_channels" title="Permalink to this definition"></a></dt>
<dd><p>rx_enabled_channels: List of enabled channels (channel 1 is 0)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="adi.rx_tx.rx_tx">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">adi.rx_tx.</span></span><span class="sig-name descname"><span class="pre">rx_tx</span></span><a class="headerlink" href="#adi.rx_tx.rx_tx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="adi.rx_tx.tx">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">adi.rx_tx.</span></span><span class="sig-name descname"><span class="pre">tx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx_cyclic_buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adi.rx_tx.tx" title="Permalink to this definition"></a></dt>
<dd><p>Buffer handling for transmit devices</p>
<dl class="py method">
<dt class="sig sig-object py" id="adi.rx_tx.tx.tx">
<span class="sig-name descname"><span class="pre">tx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adi.rx_tx.tx.tx" title="Permalink to this definition"></a></dt>
<dd><p>Transmit data to hardware buffers for each channel index in
tx_enabled_channels.</p>
<dl class="simple">
<dt>args: type=numpy.array or list of numpy.array</dt><dd><p>An array or list of arrays when more than one transmit channel
is enabled containing samples from a channel or set of channels.
Data must be complex when using a complex data device.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="adi.rx_tx.tx.tx_cyclic_buffer">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">tx_cyclic_buffer</span></span><a class="headerlink" href="#adi.rx_tx.tx.tx_cyclic_buffer" title="Permalink to this definition"></a></dt>
<dd><p>tx_cyclic_buffer: Enable cyclic buffer for TX</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="adi.rx_tx.tx.tx_destroy_buffer">
<span class="sig-name descname"><span class="pre">tx_destroy_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#adi.rx_tx.tx.tx_destroy_buffer" title="Permalink to this definition"></a></dt>
<dd><p>tx_destroy_buffer: Clears TX buffer</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="adi.rx_tx.tx.tx_enabled_channels">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">tx_enabled_channels</span></span><a class="headerlink" href="#adi.rx_tx.tx.tx_enabled_channels" title="Permalink to this definition"></a></dt>
<dd><p>tx_enabled_channels: List of enabled channels (channel 1 is 0)</p>
</dd></dl>

</dd></dl>

</section>
<section id="buffer-examples">
<h2>Buffer Examples<a class="headerlink" href="#buffer-examples" title="Permalink to this headline"></a></h2>
<p>Collect data from one channel</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">adi</span>

<span class="n">sdr</span> <span class="o">=</span> <span class="n">adi</span><span class="o">.</span><span class="n">ad9361</span><span class="p">()</span>
<span class="c1"># Get complex data back</span>
<span class="n">sdr</span><span class="o">.</span><span class="n">rx_enabled_channels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">chan1</span> <span class="o">=</span> <span class="n">sdr</span><span class="o">.</span><span class="n">rx</span><span class="p">()</span>
</pre></div>
</div>
<p>Collect data from two channels</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">adi</span>

<span class="n">sdr</span> <span class="o">=</span> <span class="n">adi</span><span class="o">.</span><span class="n">ad9361</span><span class="p">()</span>
<span class="c1"># Get both complex channel back</span>
<span class="n">sdr</span><span class="o">.</span><span class="n">rx_enabled_channels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sdr</span><span class="o">.</span><span class="n">rx</span><span class="p">()</span>
<span class="n">chan1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">chan2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Send data on two channels</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">adi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create radio</span>
<span class="n">sdr</span> <span class="o">=</span> <span class="n">adi</span><span class="o">.</span><span class="n">ad9371</span><span class="p">()</span>
<span class="n">sdr</span><span class="o">.</span><span class="n">tx_enabled_channels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># Create a sinewave waveform</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">fs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sdr</span><span class="o">.</span><span class="n">tx_sample_rate</span><span class="p">)</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mi">40000000</span>
<span class="n">ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">fc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">fc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span>
<span class="n">iq</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">q</span>
<span class="n">fc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30000000</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">fc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">fc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">14</span>
<span class="n">iq2</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">q</span>
<span class="c1"># Send data to both channels</span>
<span class="n">sdr</span><span class="o">.</span><span class="n">tx</span><span class="p">([</span><span class="n">iq</span><span class="p">,</span> <span class="n">iq2</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../devices/adi.ad7689.html" class="btn btn-neutral float-left" title="ad7689" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../fpga/index.html" class="btn btn-neutral float-right" title="FPGA Features" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Analog Devices, Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>